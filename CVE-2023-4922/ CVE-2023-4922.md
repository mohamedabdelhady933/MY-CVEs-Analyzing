# CVE-2023-4922 - Unauth LFI in WPB-Show-Core Plugin

![image](https://github.com/mohamedabdelhady933/MY-CVEs-Analyzing/assets/73122852/1c3b6350-8c56-491c-8001-390253364b8e)



## Introduction

ðŸ”Ž **CVE ID:** CVE-2023-4922

ðŸ”§ **Affected Product:** WPB-Show-Core Plugin <= 2.2

ðŸ”’ **Vendor:** WPB Show Core Projects

ðŸž **Vulnerability:** Unauthenticated Local File Inclusion

ðŸ“– **Description:** Local file inclusion that allows attackers to uthorized access to local system files and the application source code.

ðŸ“Ž **Advisory Link:** [CVE-2023-4922](https://nvd.nist.gov/vuln/detail/CVE-2023-4922)


---

## Static Analysis

In File ``download-file.php`` at  ``/wp-content/plugins/wpb-show-core/download-file.php`` endpoint 

![image](https://github.com/mohamedabdelhady933/MY-CVEs-Analyzing/assets/73122852/dc3f867e-0855-4e53-a48a-c9173e4e5188)

The snippt code shows that there is a ``path`` parameter required then doing URL decode.

The rest of the lines just set some headers , Then use ``readfile`` function that file and writes it to the output buffer.

``readfile`` function without any limitation or filteration , So it's vulnerable to local file inclusion (LFI).

## Exploitation 

Attackers can exploit this vulnerability due to ``path`` parameter via inject LFI paths such as ``download-file.php?path=/etc/hosts``.


## Mitigation

* Use filteration for the allowed files.
* Use random IDs for the needed files .
* Disable ``Allow_url_include`` because that cause SSRF too.
* Implementing Access Controls and Restrict Access.
